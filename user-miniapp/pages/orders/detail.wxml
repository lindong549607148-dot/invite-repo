<view class="page" wx:if="{{!loading && order}}">
  <view class="card section">
    <view class="row">
      <text class="label">订单号</text>
      <text class="val">{{order.orderId}}</text>
    </view>
    <view class="row">
      <text class="label">状态</text>
      <text class="status {{order.status}}">{{STATUS_MAP[order.status] || order.status}}</text>
    </view>
    <view class="row">
      <text class="label">金额</text>
      <text class="amount">¥{{(order.amount / 100).toFixed(2)}}</text>
    </view>
    <view class="row">
      <text class="label">创建时间</text>
      <text class="val">{{order.createdAt}}</text>
    </view>
  </view>

  <view class="card section" wx:if="{{order.status === 'SHIPPED' || order.status === 'RECEIVED'}}">
    <text class="label">物流信息</text>
    <block wx:if="{{logistics}}">
      <view class="row"><text class="val">承运：{{logistics.carrier || '—'}}</text></view>
      <view class="row"><text class="val">单号：{{logistics.trackingNo || '—'}}</text></view>
      <view class="row"><text class="val">状态：{{logistics.status || '—'}}</text></view>
      <view class="traces" wx:if="{{logistics.traces && logistics.traces.length}}">
        <view class="trace-item" wx:for="{{logistics.traces}}" wx:key="at">{{item.desc}} {{item.at}}</view>
      </view>
    </block>
    <view wx:else class="no-logistics">暂无物流信息</view>
  </view>
  <view class="card section" wx:elif="{{order.status === 'CREATED' || order.status === 'PAID'}}">
    <text class="no-logistics">未发货</text>
  </view>

  <view class="card section cta-card">
    <button class="btn-primary btn-big" bindtap="toTasks">去助力免单 / 查看我的任务进度</button>
  </view>
</view>
<view wx:if="{{loading}}" class="loading">加载中...</view>
<view wx:elif="{{!order}}" class="empty">订单不存在</view>
